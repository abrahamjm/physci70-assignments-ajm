<!DOCTYPE html>
<html lang="en">
<head>
  <title>PHYSCI 70: Intro to Digital Fabrication </title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link href="../style.css" rel="stylesheet">
</head>
<body>

  <div class="topnav text-center">
  <a href='../index.html'>home</a>
  <a href='../about/index.html'>about</a>
  <a href='../contact/index.html'>contact</a>
  <a href='../final project/index.html'>final project</a>
</div>

<div class="container-fluid">
  <h3>Week 4: Microcontroller programming</h3>
    <div class="row">
    
      <p> For this week's project, I was eager to use the "tone" function to create a small button-based keyboard using Arduino. My goal was to program the ItsyBitsy to create a series of pitches assigned respectivly to a series of buttons. While my goal was only to create 3 buttons (in order to play the notes "a" "b" and "e") I hoped that the project would be easily scalable into a larger keyboard. All the pitches are being played back on a small piezo buzzer.</p>

      <div class="row">

      <p> The keyboard uses 4 switches (I added one so that I could play a slightly more complex melody for my demo) each with a pulldown resistor. The switches are run into digital pins 2, 3, 4, and 5, all set as imputs. The buzzer runs from digital pin 9, set as an output. <p>

      <img src="../04_microcontroller/arduinokeyboard1.png" class="img-responsive margin" style="width:100%" alt="Arduino keyboard">

      <p>IIn the next photo, the orange wire runs from the 5v output of the Nano to the Switch, the yellow wire runs to digital pun 5, and the resistor connects from the switch to the ground in order to pull down any floating current.</p>

      <img src="../04_microcontroller/arduinokeyboard2.png" class="img-responsive margin" style="width:100%" alt="Button Side View">

      <p> The code I wrote for this 4 button keyboard is as follows.</p>

      <pre><code> 

  // setting the pin numbers//
    const int buttonPin1 = 2;     // key 1 //
    const int buttonPin2 = 3;     // key 2 //
    const int buttonPin3 = 4;     // key 3 //
    const int buttonPin4 = 5;     // key 4 //
    const int buzzerPin = 9;      // buzzer output //

  // defining the original pin states //
    int buttonState1 = 0;         // variable for reading key 1 status //
    int buttonState2 = 0;         // variable for reading key 2 status //
    int buttonState3 = 0;         // variable for reading key 3 status //
    int buttonState4 = 0;         // variable for reading key 4 status //

void setup() {
  // setting buzzerPin as output //

    pinMode(buzzerPin, OUTPUT);

  // setting button pins as imputs //
    pinMode(buttonPin1, INPUT);
    pinMode(buttonPin2, INPUT);
    pinMode(buttonPin3, INPUT);
    pinMode(buttonPin4, INPUT);
}

void loop() {
  // read the state of the button value //
    buttonState1 = digitalRead(buttonPin1);
    buttonState2 = digitalRead(buttonPin2);
    buttonState3 = digitalRead(buttonPin3);
    buttonState4 = digitalRead(buttonPin4);
    
  if (buttonState1 == HIGH) {
   tone(buzzerPin, 440);        //equal tempered A//
  } 
  else  if (buttonState2 == HIGH) {
    tone(buzzerPin, 523.25);    //equal tempered C//
   } 
  else if (buttonState3 == HIGH) {
    tone(buzzerPin, 587.33);    //equal tempered D//
  }
  else if (buttonState4 == HIGH) {
    tone(buzzerPin, 659.25);    //equal tempered E//
  }
  else{
    noTone(buzzerPin);
  }
}

    </code></pre>


      <p> Having learned from the Arduino website that one challenge the "tone" cuntion poses is that it will not fire a tone command until the previous tone command has been ended by a "noTone" function, I initially wrote my "if" and "else" functions with a "noTone" called for every pitch. When only one button was pressed, no sound was produced, and when both buttons were pressed, the buzzer squealed horribly. It looked something like this. </p>

      <pre><code> 
    
  if (buttonState1 == HIGH) {
   tone(buzzerPin, 440);
  } 
  if else (buttonState1 == LOW) {
    noTone(buzzerPin)
}

    </code></pre>

    <p> I repeated this for each output. I was confused until I sat down and wrote out the logical argument and realized the contradiction I was making. By calling "noTone" after each individual "tone," I told the keyboard not to play unless every button was pressed. The fix was simple. Now the "voide loop" could be translated as "if button one is pressed, play A, if button 2 is pressed, play C, if button 3 is pressed, play D, if button 4 is pressed, play E, and in any other case don't play anything at all. " </p>

    <div class="row">

    <p> Using these 4 notes, I made a cheesy little riff and layered over some even cheesier synth parts just to hear the brash little piezo keyboard in context. DEMO SOON TO BE UPLOADED. <p>




   
  </div>

 
  
  
</div>

</body>
</html>